<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="images/favicon.png">
    <title>Year 7 Spanish Vocabulary Practice</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        * { -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #fff 0%, #f8f8f8 100%);
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        .navbar {
            background: #DD1F25;
            color: white;
            height: 60px;
            display: flex;
            align-items: center;
            padding: 0 30px;
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: 1px;
            box-shadow: 0 2px 12px rgba(221, 31, 37, 0.15);
        }

        .navbar a {
            color: white;
            text-decoration: none;
            font-size: 1rem;
            font-weight: 500;
            margin-right: 25px;
            transition: all 0.2s ease;
            padding: 6px 12px;
            border-radius: 4px;
        }

        .navbar a:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(-3px);
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .page-title {
            font-size: 2.2rem;
            font-weight: 700;
            color: #DD1F25;
            text-align: center;
            margin-bottom: 40px;
        }

        .section {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 14px rgba(221, 31, 37, 0.09);
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #DD1F25;
            margin-bottom: 20px;
        }

        .module-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .module-btn, .week-btn {
            background: rgba(221, 31, 37, 0.05);
            border: 2px solid #DD1F25;
            color: #DD1F25;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.25s ease;
            font-weight: 600;
            font-size: 0.95rem;
        }

        .module-btn:hover, .week-btn:hover {
            background: #DD1F25;
            color: white;
            transform: translateY(-1px);
        }

        /* Disable hover on touch devices */
        @media (hover: none) {
            .module-btn:hover, .week-btn:hover {
                background: rgba(221, 31, 37, 0.05);
                color: #DD1F25;
                transform: none;
            }
            .module-btn.selected:hover, .week-btn.selected:hover {
                background: #DD1F25;
                color: white;
            }
            .module-btn.has-selections:hover {
                background: rgba(221, 31, 37, 0.44);
                color: #DD1F25;
            }
        }

        .module-btn.selected, .week-btn.selected {
            background: #DD1F25;
            color: white;
        }

        .module-btn.selected:hover, .week-btn.selected:hover {
            background: #c11a1f;
        }

        .module-btn.has-selections {
            background: rgba(221, 31, 37, 0.44);
            border-color: #DD1F25;
            color: #DD1F25;
            font-weight: 700;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .select-all-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            user-select: none;
            padding: 8px 12px;
            border-radius: 6px;
            transition: background 0.2s;
        }

        .select-all-checkbox:hover {
            background: rgba(221, 31, 37, 0.05);
        }

        .select-all-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #DD1F25;
        }

        .select-all-checkbox label {
            cursor: pointer;
            font-weight: 600;
            color: #DD1F25;
            font-size: 0.9rem;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .setting-card {
            background: #f8f8f8;
            border-radius: 8px;
            padding: 20px;
        }

        .setting-label {
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            display: block;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 12px 16px;
            border-radius: 8px;
            background: white;
            border: 2px solid #e0e0e0;
            transition: all 0.2s;
        }

        .radio-option:hover {
            border-color: #DD1F25;
            background: rgba(221, 31, 37, 0.02);
        }

        .radio-option input[type="radio"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #DD1F25;
        }

        .radio-option input[type="radio"]:checked + span {
            color: #DD1F25;
            font-weight: 600;
        }

        .radio-option:has(input[type="radio"]:checked) {
            border-color: #DD1F25;
            background: rgba(221, 31, 37, 0.05);
        }

        .start-btn {
            background: #DD1F25;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: 700;
            border-radius: 8px;
            cursor: pointer;
            display: block;
            margin: 30px auto 0;
            transition: all 0.3s;
        }

        .start-btn:hover {
            background: #c11a1f;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(221, 31, 37, 0.3);
        }

        .start-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        /* Test Interface */
        .test-container {
            display: none;
        }

        .test-container.active {
            display: block;
        }

        .test-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .back-to-setup-btn {
            background: #DD1F25;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .back-to-setup-btn:hover {
            background: #c11a1f;
            transform: translateX(-3px);
        }

        .progress-bar {
            background: #e0e0e0;
            height: 10px;
            border-radius: 5px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            background: #DD1F25;
            height: 100%;
            transition: width 0.3s;
        }

        .flashcard {
            background: white;
            border-radius: 12px;
            padding: 60px 40px;
            text-align: center;
            box-shadow: 0 6px 24px rgba(221, 31, 37, 0.15);
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .flashcard:hover {
            transform: scale(1.02);
        }

        .flashcard-question {
            font-size: 2rem;
            font-weight: 700;
            color: #DD1F25;
            margin-bottom: 20px;
        }

        .flashcard-answer {
            font-size: 1.5rem;
            color: #666;
            display: none;
        }

        .flashcard.revealed .flashcard-answer {
            display: block;
        }

        .typing-test {
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 6px 24px rgba(221, 31, 37, 0.15);
            position: relative;
        }

        .typing-question {
            font-size: 1.8rem;
            font-weight: 700;
            color: #DD1F25;
            margin-bottom: 30px;
            text-align: center;
        }

        .typing-input {
            width: 100%;
            padding: 15px;
            font-size: 1.2rem;
            border: 2px solid #DD1F25;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .submit-btn {
            background: #DD1F25;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: block;
            margin: 20px auto 0 auto;
        }

        .submit-btn:hover {
            background: #c11a1f;
        }

        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            font-weight: 600;
            text-align: center;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
        }

        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
        }

        .next-btn {
            background: #DD1F25;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.2s;
        }

        .next-btn:hover {
            background: #c11a1f;
        }

        .running-total {
            position: absolute;
            bottom: 20px;
            right: 20px;
            font-size: 0.8rem;
            color: #999;
            font-weight: 500;
        }

        .results {
            background: white;
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 6px 24px rgba(221, 31, 37, 0.15);
        }

        .results-title {
            font-size: 2rem;
            font-weight: 700;
            color: #DD1F25;
            margin-bottom: 20px;
        }

        .results-score {
            font-size: 3rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .settings-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="navbar">
        <a href="../spanish-vocab.html">‚Üê Back</a>
        Year 7 Quiz
    </div>

    <div class="container">
        <!-- Setup Interface -->
        <div id="setupInterface">
            <h1 class="page-title">Vocabulary Practice</h1>

            <div class="section">
                <div class="section-header">
                    <h2 class="section-title" style="margin-bottom: 0;">Select Modules</h2>
                    <div class="select-all-checkbox" onclick="selectAllModules()">
                        <input type="checkbox" id="allModulesCheckbox" onclick="event.stopPropagation(); selectAllModules();">
                        <label for="allModulesCheckbox" onclick="event.stopPropagation(); selectAllModules();">All Modules</label>
                    </div>
                </div>
                <div class="module-grid" id="moduleSelection"></div>
            </div>

            <div class="section" id="weekSection" style="display: none;">
                <div class="section-header">
                    <h2 class="section-title" style="margin-bottom: 0;">Select Weeks</h2>
                    <div class="select-all-checkbox" onclick="selectAllWeeks()">
                        <input type="checkbox" id="allWeeksCheckbox" onclick="event.stopPropagation(); selectAllWeeks();">
                        <label for="allWeeksCheckbox" onclick="event.stopPropagation(); selectAllWeeks();">Select All</label>
                    </div>
                </div>
                <div class="module-grid" id="weekSelection"></div>
            </div>

            <div class="section">
                <h2 class="section-title">Test Settings</h2>
                <div class="settings-grid">
                    <div class="setting-card">
                        <label class="setting-label">Direction</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="direction" value="es-en" checked>
                                <span>Spanish ‚Üí English</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="direction" value="en-es">
                                <span>English ‚Üí Spanish</span>
                            </label>
                        </div>
                    </div>
                    <div class="setting-card">
                        <label class="setting-label">Mode</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="mode" value="flashcards" checked>
                                <span>Flashcards</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="mode" value="typing">
                                <span>Type Answers</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <button class="start-btn" id="startBtn" disabled>Start Practice</button>
        </div>

        <!-- Test Interface -->
        <div class="test-container" id="testInterface">
            <div class="test-header">
                <button class="back-to-setup-btn" onclick="backToSetup()">
                    <span>‚Üê</span>
                    <span>Back to Year 7 Vocab</span>
                </button>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div id="testContent"></div>
        </div>
    </div>

    <script>
        // Vocabulary Data Structure
        const VOCAB_DATA = `
Module 1:
Week 1:
Hola - Hello
¬øC√≥mo te llamas? - What are you called? / What is your name?
Me llamo... - I am called... / My name is...
¬øQu√© tal? - How are you?
Fenomenal - Great
Bien - Good
Regular - Not bad/Okay
Fatal - Awful
Hasta luego - See you later
Adi√≥s - Goodbye

Week 2:
¬øQu√© tipo de persona eres? - What sort of person are you?
Soy... - I am...
Sincero / Sincera - Sincere
T√≠mido / T√≠mida - Shy
Tranquilo / Tranquila - Calm / Quiet
Divertido / Divertida - Fun
Serio / Seria - Serious
Simp√°tico / Simp√°tica - Nice / Kind
Tonto / Tonta - Silly
Generoso / Generosa - Generous

Week 3:
¬øTienes hermanos? - Do you have any siblings?
Tengo... - I have...
Un hermano - A brother
Una hermana - A sister
Un hermanastro - A stepbrother/Half-brother
Una hermanastra - A stepsister/Half-sister
¬øCu√°ntos a√±os tienes? - How old are you?
Tengo once a√±os - I am eleven years old
Enero - January
Febrero - February

Week 4:
Marzo - March
Abril - April
Mayo - May
Junio - June
Julio - July
Agosto - August
Septiembre - September
Octubre - October
Noviembre - November
Diciembre - December

Week 5:
¬øTienes mascotas? - Do you have any pets?
Un perro - A dog
Un gato - A cat
Un pez - A fish
Un conejo - A rabbit
Un rat√≥n - A mouse
Una serpiente - A snake
Una cobaya - A guinea pig
Una tortuga - A tortoise / A turtle
No tengo mascotas - I do not have any pets

Week 6:
Blanco / Blanca - White
Negro / Negra - Black
Rojo / Roja - Red
Azul - Blue
Amarillo / Amarilla - Yellow
Naranja - Orange
Marr√≥n - Brown
Gris - Grey
Rosa - Pink
Verde - Green

Module 2:
Week 1:
¬øQu√© te gusta hacer? - What do you like to do?
Me gusta... - I like...
Me gusta mucho... - I really like...
No me gusta... - I do not like...
No me gusta nada... - I do not like at all...
Navegar por internet - To surf the internet
Chatear - To chat
Escuchar m√∫sica - To listen to music
Jugar a los videojuegos - To play videogames
Ver la televisi√≥n - To watch television
Leer - To read
Escribir correos - To write emails
Salir con mis amigos - To go out with my friends
Pero - But
Porque - Because

Week 2:
¬øQu√© haces en tu tiempo libre? - What do you do in your free time?
Bailo - I dance
Toco la guitarra - I play the guitar
Saco fotos - I take photos
Hablo con mis amigos - I talk with my friends
Canto - I sing
Hablo - I talk
Hablas - You talk
Habla - He/She/It talks
Hablamos - We talk
Habl√°is - You (pl) talk
Hablan - They talk
Es interesante - It is interesting
Es aburrido - It is boring
Es divertido - It is fun

Week 3:
Hace buen tiempo - It is nice weather
Hace mal tiempo - It is bad weather
Hace calor - It is hot
Hace fr√≠o - It is cold
Hace sol - It is sunny
Llueve - It is raining
Nieva - It is snowing
¬øQu√© deportes haces? - What sports do you do?
Hago gimnasia - I do gymnastics
Hago artes marciales - I do martial arts
Hago nataci√≥n - I do swimming
Juego al f√∫tbol - I play football
Juego al tenis - I play tennis
Juego al voleibol - I play volleyball
Juego al baloncesto - I play basketball

Week 4:
Lunes - Monday
Martes - Tuesday
Mi√©rcoles - Wednesday
Jueves - Thursday
Viernes - Friday
S√°bado - Saturday
Domingo - Sunday
Los lunes - On Mondays
Juego - I play
Juegas - You play
Juega - He plays / She plays / It plays
Jugamos - We play
Jug√°is - You (pl) play
Juegan - They play
Me encanta - I love (it)

Week 5:
¬øQu√©? - What?
¬øCu√°ndo? - When?
¬øD√≥nde? - Where?
¬øC√≥mo? - How/What?
¬øCu√°ntos? - How many?
Hago - I do/make
Haces - You do/ You make
Hace - He makes/ She makes/ It makes/ He does/ She does/ It does
Hacemos - We do / We make
Hac√©is - You (pl) do/ You (pl) make
Hacen - They do/make
Todos los d√≠as - Every day
A veces - Sometimes
Nunca - Never
De vez en cuando - From time to time

Module 3:
Week 1:
¬øQu√© estudias? - What do you study?
El ingl√©s - English
El espa√±ol - Spanish
El franc√©s - French
El dibujo - Art
El teatro - Drama
La inform√°tica - Computing
La geograf√≠a - Geography
La historia - History
La educaci√≥n f√≠sica - P.E.
La m√∫sica - Music
La religi√≥n - E.P.R
La tecnolog√≠a - Design Technology (D.E.)
Las matem√°ticas - Mathematics / Maths
Las ciencias - Science

Week 2:
¬øCu√°l es tu d√≠a favorito? - What is your favourite day?
Mi d√≠a favorito es... - My favourite day is...
El lunes - Monday
Los lunes - On Mondays
¬øPor qu√©? - Why?
Porque... - Because
Estudio - I study
Estudiamos - We study
No estudio - I do not study
¬øTe gusta(n)...? - Do you like...?
Me gusta(n)... - I like...
Me gusta(n) mucho... - I really like...
Me encanta(n)... - I love...
No me gusta(n)... - I do not like...
No me gusta(n) nada... - I do not like at all...

Week 3:
¬øTe gusta el dibujo? - Do you like art?
Me gusta el ingl√©s - I like English
Me gustan las matem√°ticas - I like mathematics / I like maths
Es... - It is...
Son... - They are...
Aburrido - Boring
Divertido - Fun
Pr√°ctico - Practical
Dif√≠cil - Difficult
F√°cil - Easy
√ötil - Useful
Raro - Strange
Severo - Strict
Mi profesora de historia - My (female) history teacher
Mi profesor de ciencias - My (male) Science teacher

Week 4:
En mi instituto hay... - In my school there is...
Un campo de f√∫tbol - A football pitch
Un comedor - A dining room
Un gimnasio - A gym
Un patio - A playground
Una clase de inform√°tica - A computing classroom
Una piscina - A (swimming) pool
Una biblioteca - A library
Unos laboratorios - Some laboratories
Moderno - Modern
Antiguo - Old
Bonito - Pretty
Feo - Ugly
Peque√±o - Small
Grande - Big

Week 5:
¬øQu√© haces durante el recreo? - What do you do during break?
Como... - I eat...
Un bocadillo - A sandwich
Una pizza - A pizza
Una chocolatina - A chocolate bar
Unos caramelos - Some sweets
Unas patatas fritas - Some crisps
Fruta - Fruit
Bebo... - I drink
Agua - Water
Zumo (de naranja) - (Orange) juice
Un refresco - A fizzy drink
Escucho m√∫sica - I listen to music
Leo un libro - I read a book
Escribo SMS / Escribo mensajes - I write (text) messages

Module 4:
Week 1:
¬øCu√°ntas personas hay en tu familia? - How many people are there in your family?
Hay... - There are...
Mi madre - My mum
Mi padre - My dad
Mis hermanos - My siblings
Mi t√≠a - My aunt
Mi t√≠o - My uncle
Mis primos - My cousins
Mi abuela - My grandma
Mi abuelo - My grandpa
Mi bisabuela - My great grandma
Se llama... - It is called
Tiene ... a√±os - He is ... years old / She is ... years old
Tu(s) - Your
Su(s) - His/Her/Their

Week 2:
¬øDe qu√© color tienes los ojos? - What colour are your eyes?
Tengo los ojos... - I have ... eyes
Azul / Azules - Blue
Marr√≥n / Marrones - Brown
Gris / Grises - Grey
Verde / Verdes - Green
Llevo gafas - I wear glasses
¬øC√≥mo tienes el pelo? - What is your hair like?
Tengo el pelo... - I have ... hair
Rubio - Blonde
Casta√±o - Brown (Brunette)
Liso - Straight
Rizado - Curly
Largo - Long
Corto - Short

Week 3:
Tener - To have
Tengo - I have
Tienes - You have
Tiene - He has/ She has/ It has
Tenemos - We have
Ten√©is - You(pl) have
Tienen - They have
Ser - To be
Soy - I am
Eres - You are
Es - He/She/It is
Somos - We are
Sois - You(pl) are
Son - They are
Adem√°s - Also/In addition

Week 4:
¬øC√≥mo es? - What is he like? / What is she like?
Alto - Tall
Bajo - Short
Joven - Young
Viejo - Old
Guapo - Good looking
Feo - Ugly
Delgado - Thin
Gordo - Fat
El bigote - Moustache
La barba - Beard
Las pecas - Freckles
Muy - Very
Bastante - Quite
Un poco - A bit

Week 5:
¬øC√≥mo es tu casa o tu piso? - What is your house or your flat like?
Vivo en... - I live in...
Una casa bonita - A pretty house
Una casa antigua - An old house
Una casa grande - A big house
Una casa moderna - A modern house
Un piso c√≥modo - A comfortable flat
Un piso peque√±o - A small flat
Est√° en... - It is in...
La monta√±a - The mountain
Un pueblo - A town
Una ciudad - A city
La costa - The coast
El campo - The countryside
El desierto - The desert

Module 5:
Week 1:
¬øQu√© hay en tu pueblo? - What is in your town?
Hay... - There is/ There are...
Un castillo - A castle
Un mercado - A market
Un estadio - A stadium
Un centro comercial - A shopping centre
Un polideportivo - A sports centre
Una piscina - A swimming pool
Unos museos - Some museums
Unas plazas - Some squares
Muchos parques - Many parks/Lots of parks
Muchos restaurantes - Many restaurants/Lots of restaurants
Muchas tiendas - Many shops/Lots of shops
No hay nada - There isn't anything

Week 2:
¬øQu√© hora es? - What time is it?
Es la una - It is one o'clock
Son las dos - It is two o'clock
Son las tres y cuarto - It is quarter past three
Son las cuatro y media - It is half past four
Son las cinco menos cuarto - It is a quarter to five
Son las seis y cinco - It is five past six
Son las siete y diez - It is ten past seven
Son las ocho y veinte - It is twenty past eight
Son las nueve menos veinticinco - It is twenty-five to nine
Son las diez menos cinco - It is five to ten
Son las once menos diez - It is ten to eleven
Son las doce menos veinte - It is twenty to twelve
...de la ma√±ana - ...In the morning (A.M.)
...de la tarde - ...In the afternoon (P.M.)

Week 3:
¬øQu√© haces en la ciudad? - What do you do in the city?
Salgo con mis amigos - I go out with my friends
Voy al cine - I go to the cinema
Voy al parque - I go to the park
Voy a la cafeter√≠a - I go to the caf√©
Voy a la bolera - I go to the bowling alley
Voy a la playa - I go to the beach
Voy de paseo con mi familia - I go on a walk with my family
Voy de compras - I go shopping
No hago nada - I do not do anything
Vas - You go
Va - He goes / She goes / It goes
Vamos - We go
Vais - You(pl) go
Van - They go

Week 4:
¬øQu√© quieres? - What do you want?
Quiero... - I want...
Una bebida - A drink
Un caf√© - A coffee
Un t√© - A tea
Una fanta lim√≥n/naranja - A lemon fanta / An orange fanta
Un batido de chocolate/fresa - A chocolate milkshake /A strawberry milkshake
Una Coca-Cola - A Coca-Cola
Un granizado de lim√≥n - A lemon slush / A lemon snow cone
Una raci√≥n de... - A portion of...
Gambas - Prawns
Jam√≥n - Ham
Calamares - Squid rings
Croquetas - Croquettes
Tortilla - Omelette

Week 5:
Patatas bravas - Spicy potatoes
Pan con tomate - Bread with tomato
A ver... - Let's see...
Bueno - Well...
¬øAlgo m√°s? - Anything else?
¬øQu√© vas a hacer? - What are you going to do?
Voy a jugar - I am going to play
Vas a bailar - You are going to dance
Va a ser - He is going to be/ She is going to be/ It is going to be
Vamos a ver - We are going to see/ We are going to watch
Vais a ir - You(pl) are going to go
Van a comer - They are going to eat
Primero - First
Luego - Then
Finalmente - Finally
`;

        // Parse vocabulary data
        function parseVocabData(text) {
            const modules = {};
            const lines = text.trim().split('\n');
            let currentModule = null;
            let currentWeek = null;

            for (let line of lines) {
                line = line.trim();
                if (!line) continue;

                if (line.startsWith('Module ')) {
                    const moduleNum = line.match(/Module (\d+):/)[1];
                    currentModule = `Module ${moduleNum}`;
                    modules[currentModule] = {};
                } else if (line.startsWith('Week ')) {
                    const weekNum = line.match(/Week (\d+):/)[1];
                    currentWeek = `Week ${weekNum}`;
                    modules[currentModule][currentWeek] = [];
                } else if (line.includes(' - ')) {
                    const [spanish, english] = line.split(' - ').map(s => s.trim());
                    modules[currentModule][currentWeek].push({ spanish, english });
                }
            }

            return modules;
        }

        const vocabData = parseVocabData(VOCAB_DATA);
        let currentModule = null;  // Track currently selected module
        let selectedWeeksByModule = {};  // Store selected weeks for each module
        let testQuestions = [];
        let currentQuestion = 0;
        let correctAnswers = 0;

        // Initialize UI
        function initializeUI() {
            const moduleSelection = document.getElementById('moduleSelection');
            
            Object.keys(vocabData).forEach(module => {
                const btn = document.createElement('button');
                btn.className = 'module-btn';
                btn.textContent = module;
                btn.onclick = () => toggleModule(module, btn);
                moduleSelection.appendChild(btn);
            });
        }

        function toggleModule(module, btn) {
            // Deselect all other module buttons
            const allModuleBtns = document.querySelectorAll('.module-btn');
            allModuleBtns.forEach(b => {
                b.classList.remove('selected');
                // Check if this module has selections and isn't the current one
                const moduleName = b.textContent;
                if (selectedWeeksByModule[moduleName] && selectedWeeksByModule[moduleName].size > 0) {
                    b.classList.add('has-selections');
                } else {
                    b.classList.remove('has-selections');
                }
            });
            
            // Select this module and remove has-selections class (selected takes priority)
            currentModule = module;
            btn.classList.add('selected');
            btn.classList.remove('has-selections');
            
            updateWeekSelection();
            updateStartButton();
        }

        function updateWeekSelection() {
            const weekSection = document.getElementById('weekSection');
            const weekSelection = document.getElementById('weekSelection');
            
            if (!currentModule) {
                weekSection.style.display = 'none';
                return;
            }

            weekSection.style.display = 'block';
            weekSelection.innerHTML = '';

            // Initialize selected weeks for this module if not exists
            if (!selectedWeeksByModule[currentModule]) {
                selectedWeeksByModule[currentModule] = new Set();
            }

            // Show only weeks for the current module
            Object.keys(vocabData[currentModule]).forEach(week => {
                const btn = document.createElement('button');
                btn.className = 'week-btn';
                btn.textContent = `${currentModule} - ${week}`;
                btn.dataset.module = currentModule;
                btn.dataset.week = week;
                
                // Check if this week was previously selected
                const key = `${currentModule}-${week}`;
                if (selectedWeeksByModule[currentModule].has(week)) {
                    btn.classList.add('selected');
                }
                
                btn.onclick = () => toggleWeek(currentModule, week, btn);
                weekSelection.appendChild(btn);
            });
            
            // Update the Select All checkbox state
            updateAllWeeksCheckbox();
        }

        function toggleWeek(module, week, btn) {
            if (!selectedWeeksByModule[module]) {
                selectedWeeksByModule[module] = new Set();
            }
            
            if (selectedWeeksByModule[module].has(week)) {
                selectedWeeksByModule[module].delete(week);
                btn.classList.remove('selected');
            } else {
                selectedWeeksByModule[module].add(week);
                btn.classList.add('selected');
            }
            
            updateStartButton();
            updateModuleStates();
            updateAllWeeksCheckbox();
            updateAllModulesCheckbox();
        }

        function updateModuleStates() {
            // Update all module buttons to show has-selections state
            const allModuleBtns = document.querySelectorAll('.module-btn:not(#selectAllModulesBtn)');
            allModuleBtns.forEach(btn => {
                const moduleName = btn.textContent;
                if ((moduleName !== currentModule) && selectedWeeksByModule[moduleName] && selectedWeeksByModule[moduleName].size > 0) {
                    btn.classList.add('has-selections');
                } else if (moduleName !== currentModule) {
                    btn.classList.remove('has-selections');
                }
            });
        }

        function updateStartButton() {
            const startBtn = document.getElementById('startBtn');
            // Check if any weeks are selected across all modules
            let totalSelected = 0;
            Object.values(selectedWeeksByModule).forEach(weekSet => {
                totalSelected += weekSet.size;
            });
            startBtn.disabled = totalSelected === 0;
        }

        function selectAllWeeks() {
            if (!currentModule) return;
            
            const checkbox = document.getElementById('allWeeksCheckbox');
            
            // Initialize if needed
            if (!selectedWeeksByModule[currentModule]) {
                selectedWeeksByModule[currentModule] = new Set();
            }
            
            // Get all weeks for current module
            const weeks = Object.keys(vocabData[currentModule]);
            
            // Use checkbox state to determine action
            if (checkbox && checkbox.checked) {
                // Select all with smooth fade
                weeks.forEach(week => {
                    selectedWeeksByModule[currentModule].add(week);
                    const btn = document.querySelector(`.week-btn[data-week="${week}"]`);
                    if (btn) btn.classList.add('selected');
                });
            } else {
                // Deselect all
                weeks.forEach(week => {
                    selectedWeeksByModule[currentModule].delete(week);
                    const btn = document.querySelector(`.week-btn[data-week="${week}"]`);
                    if (btn) btn.classList.remove('selected');
                });
            }
            
            updateStartButton();
            updateModuleStates();
        }

        function selectAllModules() {
            const checkbox = document.getElementById('allModulesCheckbox');
            const modules = Object.keys(vocabData);
            
            // Use checkbox state to determine action
            if (checkbox && checkbox.checked) {
                // Select all weeks in all modules
                modules.forEach(module => {
                    if (!selectedWeeksByModule[module]) {
                        selectedWeeksByModule[module] = new Set();
                    }
                    const weeks = Object.keys(vocabData[module]);
                    weeks.forEach(week => {
                        selectedWeeksByModule[module].add(week);
                    });
                });
            } else {
                // Deselect all
                modules.forEach(module => {
                    selectedWeeksByModule[module] = new Set();
                });
            }
            
            // Update UI
            updateWeekSelection();
            updateStartButton();
            updateModuleStates();
            updateAllModulesCheckbox();
        }

        function updateAllWeeksCheckbox() {
            if (!currentModule) return;
            
            const checkbox = document.getElementById('allWeeksCheckbox');
            if (!checkbox) return;
            
            const weeks = Object.keys(vocabData[currentModule]);
            const allSelected = weeks.every(week => 
                selectedWeeksByModule[currentModule] && selectedWeeksByModule[currentModule].has(week)
            );
            
            checkbox.checked = allSelected;
        }

        function updateAllModulesCheckbox() {
            const checkbox = document.getElementById('allModulesCheckbox');
            if (!checkbox) return;
            
            const modules = Object.keys(vocabData);
            const allFullySelected = modules.every(module => {
                const weeks = Object.keys(vocabData[module]);
                return selectedWeeksByModule[module] && weeks.every(week => selectedWeeksByModule[module].has(week));
            });
            
            checkbox.checked = allFullySelected;
        }

        // Test functionality
        function startTest() {
            const direction = document.querySelector('input[name="direction"]:checked').value;
            const mode = document.querySelector('input[name="mode"]:checked').value;

            // Collect questions from all selected weeks across all modules
            testQuestions = [];
            Object.keys(selectedWeeksByModule).forEach(module => {
                selectedWeeksByModule[module].forEach(week => {
                    const vocab = vocabData[module][week];
                    
                    vocab.forEach(item => {
                        testQuestions.push({
                            question: direction === 'es-en' ? item.spanish : item.english,
                            answer: direction === 'es-en' ? item.english : item.spanish,
                            spanish: item.spanish,
                            english: item.english
                        });
                    });
                });
            });

            // Shuffle questions
            testQuestions = testQuestions.sort(() => Math.random() - 0.5);
            currentQuestion = 0;
            correctAnswers = 0;

            // Show test interface
            document.getElementById('setupInterface').style.display = 'none';
            document.getElementById('testInterface').classList.add('active');

            if (mode === 'flashcards') {
                showFlashcard();
            } else {
                showTypingTest();
            }
        }

        function showFlashcard() {
            const testContent = document.getElementById('testContent');
            const question = testQuestions[currentQuestion];
            
            testContent.innerHTML = `
                <div class="flashcard" onclick="this.classList.toggle('revealed')">
                    <div class="flashcard-question">${question.question}</div>
                    <div class="flashcard-answer">${question.answer}</div>
                    <p style="margin-top: 30px; color: #999; font-size: 0.9rem;">Click to reveal answer</p>
                </div>
                <button class="next-btn" onclick="nextQuestion()" style="display: block; margin: 20px auto;">Next</button>
            `;
            
            updateProgress();
        }

        function showTypingTest() {
            // Remove any existing Enter listener from previous question
            document.removeEventListener('keypress', handleTypingEnter);
            
            const testContent = document.getElementById('testContent');
            const question = testQuestions[currentQuestion];
            
            testContent.innerHTML = `
                <div class="typing-test">
                    <div class="typing-question">${question.question}</div>
                    <input type="text" class="typing-input" id="answerInput" placeholder="Type your answer..." autocomplete="off">
                    <button class="submit-btn" onclick="checkAnswer()">Submit</button>
                    <div id="feedback"></div>
                    <div class="running-total" id="runningTotal"></div>
                </div>
            `;
            
            document.getElementById('answerInput').focus();
            document.addEventListener('keypress', handleTypingEnter);
            
            updateProgress();
            updateRunningTotal();
        }

        function handleTypingEnter(e) {
            if (e.key === 'Enter') {
                const input = document.getElementById('answerInput');
                if (!input.disabled) {
                    checkAnswer();
                } else {
                    nextQuestion();
                }
            }
        }

        function normalizeAnswer(text) {
            return text.toLowerCase()
                .trim()
                .replace(/\?/g, '')
                .replace(/¬ø/g, '')
                .replace(/\!/g, '')
                .replace(/¬°/g, '')
                .replace(/\.\.\./g, '') // Remove ... BEFORE removing single dots
                .replace(/‚Ä¶/g, '') // Remove ellipsis character
                .replace(/\./g, '') // Now remove single dots
                .replace(/\(.*?\)/g, '')
                .replace(/\s+/g, ' ')
                .trim();
        }

        function checkAnswer() {
            const input = document.getElementById('answerInput');
            const feedback = document.getElementById('feedback');
            
            // First, normalize and check without replacements
            let userAnswer = normalizeAnswer(input.value);
            const correctAnswer = normalizeAnswer(testQuestions[currentQuestion].answer);
            
            // Handle multiple possible answers separated by /
            const possibleAnswers = correctAnswer.split('/').map(a => a.trim());
            
            // Check if already correct
            let isCorrect = possibleAnswers.some(ans => userAnswer === ans) || 
                           possibleAnswers.every(ans => userAnswer.includes(ans));
            
            // Only apply replacements if the answer is incorrect
            if (!isCorrect) {
                const replacements = {
                    "its": "it is",
                    "it's": "it is",
                    "dont": "do not",
                    "don't": "do not",
                    "i'm": "i am",
                    "im": "i am",
                    "whats": "what is",
                    "what's": "what is",
                    "his": "his/her",
                    "her": "his/her",
                    "pe": "pe",
                    "a lot": "lots",
                    "tv": "television",
                    "type": "sort",
                    "1":"one",
                    "2":"two",
                    "3":"three",
                    "4":"four",
                    "5":"five",
                    "6":"six",
                    "7":"seven",
                    "8":"eight",
                    "9":"nine",
                    "10":"ten",
                    "11":"eleven",
                    "12":"twelve",
                    "13":"thirteen",
                    "14":"fourteen",
                    "15":"fifteen",
                    "16":"sixteen",
                    "17":"seventeen",
                    "18":"eighteen",
                    "19":"nineteen",
                    "20":"twenty",
                    "21":"twenty-one",
                    "22":"twenty-two",
                    "23":"twenty-three",
                    "24":"twenty-four",
                    "25":"twenty-five",
                    "26":"twenty-six",
                    "27":"twenty-seven",
                    "28":"twenty-eight",
                    "29":"twenty-nine",
                    "30":"thirty",
                    "gray":"grey",
                    "he's":"he is",
                    "she's":"she is",
                    "speak": "talk",
                    "class": "classroom",
                    "religion": "epr",
                    "labs": "laboratories",
                    "mother": "mum",
                    "father": "dad",
                };
                
                // Apply replacements to user answer (already lowercase)
                Object.keys(replacements).forEach(word => {
                    userAnswer = userAnswer.replace(new RegExp(`\\b${word}\\b`, 'gi'), replacements[word]);
                });
                
                // Check again after replacements
                isCorrect = possibleAnswers.some(ans => userAnswer === ans) || 
                           possibleAnswers.every(ans => userAnswer.includes(ans));
            }

            if (isCorrect) {
                correctAnswers++;
                feedback.className = 'feedback correct';
                feedback.innerHTML = `‚úì Correct! <br><button class="next-btn" onclick="nextQuestion()">Next</button>`;
            } else {
                feedback.className = 'feedback incorrect';
                feedback.innerHTML = `‚úó Incorrect. The answer is: ${testQuestions[currentQuestion].answer}<br><button class="next-btn" onclick="nextQuestion()">Next</button>`;
            }

            input.disabled = true;
            updateRunningTotal();
        }

        function nextQuestion() {
            currentQuestion++;
            
            if (currentQuestion >= testQuestions.length) {
                showResults();
            } else {
                const mode = document.querySelector('input[name="mode"]:checked').value;
                if (mode === 'flashcards') {
                    showFlashcard();
                } else {
                    showTypingTest();
                }
            }
        }

        function updateProgress() {
            const progress = ((currentQuestion + 1) / testQuestions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function updateRunningTotal() {
            const runningTotal = document.getElementById('runningTotal');
            if (runningTotal) {
                const feedback = document.getElementById('feedback');
                let denominator;
                // If feedback is visible, user has just answered
                if (feedback && feedback.innerHTML.trim() !== "") {
                    denominator = currentQuestion + 1;
                } else {
                    denominator = currentQuestion;
                }
                const percentage = denominator > 0 ? Math.round((correctAnswers / denominator) * 100) : 0;
                runningTotal.innerHTML = `${correctAnswers}/${denominator} (${percentage}%)`;
            }
        }

        function showResults() {
            const testContent = document.getElementById('testContent');
            const mode = document.querySelector('input[name="mode"]:checked').value;
            const percentage = Math.round((correctAnswers / testQuestions.length) * 100);
            
            if (mode === 'flashcards') {
                // Flashcard mode - no scoring
                testContent.innerHTML = `
                    <div class="results">
                        <div class="results-title">All Done! üéâ</div>
                        <div style="font-size: 1.3rem; color: #666; margin-bottom: 20px;">
                            You reviewed <strong>${testQuestions.length}</strong> vocabulary items
                        </div>
                        <button class="start-btn" onclick="location.reload()">Start New Practice</button>
                    </div>
                `;
            } else {
                // Typing mode - show score
                testContent.innerHTML = `
                    <div class="results">
                        <div class="results-title">Test Complete!</div>
                        <div class="results-score">${correctAnswers} / ${testQuestions.length}</div>
                        <div style="font-size: 1.5rem; color: #666; margin-bottom: 30px;">${percentage}%</div>
                        <button class="start-btn" onclick="location.reload()">Start New Test</button>
                    </div>
                `;
            }
        }

        function backToSetup() {
            // Hide test interface and show setup interface
            document.getElementById('testInterface').classList.remove('active');
            document.getElementById('setupInterface').style.display = 'block';
            
            // Reset test state
            currentQuestion = 0;
            correctAnswers = 0;
            testQuestions = [];
        }

        // Event listeners
        document.getElementById('startBtn').onclick = startTest;

        // Initialize
        initializeUI();
    </script>
</body>
</html>
